define(["jquery"],function(g){function v(e){return"boolean"==typeof e?e:"number"==typeof e?1===e:"string"==typeof e&&("1"===e||"true"===e.toLowerCase())}function y(e,t){return e=parseInt(e,10),isNaN(e)?t:e}function x(e){return"click"===e.type||"keydown"===e.type&&(e.which===t.ENTER||e.which===t.SPACE)}var t={ENTER:13,SPACE:32},T={layoutMode:"vertical",imageFit:"cover",imageHeight:200,borderRadius:8,animationSpeed:300,autoslide:0,showButton:!0,showCards:!0,showCategory:!0,showContact:!0,showContactPicture:!0,showLastmodified:!0};return{init:function(e,i,t){if(Array.isArray(i)&&0!==i.length){e=g("#"+e);if(e.length){var n=g.extend({},T,t||{}),r=(n.imageHeight=y(n.imageHeight,T.imageHeight),n.borderRadius=y(n.borderRadius,T.borderRadius),n.animationSpeed=y(n.animationSpeed,T.animationSpeed),n.autoslide=y(n.autoslide,T.autoslide),n.showButton=v(n.showButton),n.showCards=v(n.showCards),n.showCategory=v(n.showCategory),n.showContact=v(n.showContact),n.showContactPicture=v(n.showContactPicture),n.showLastmodified=v(n.showLastmodified),{currentIndex:0,coursesCount:i.length,autoslideTimer:null}),o=e.find(".main-course-wrapper");if(o.length){var a=e.find(".slider-indicators"),d=n.showCards?e.find(".course-cards"):g(),s=(d.length||(d=null),function(){r.coursesCount<=1||(a.find(".dot").removeClass("active"),a.find('.dot[data-index="'+r.currentIndex+'"]').addClass("active"))}),u=function(e){var t,a=o.find(".course-meta-info");a.empty(),n.showCategory&&e.category&&(t=g("<div>").addClass("meta-item meta-category"),g("<i>").addClass("fa fa-folder-open").appendTo(t),g("<span>").text(e.category).appendTo(t),a.append(t)),n.showContact&&e.contact&&e.contact.name&&(t=g("<div>").addClass("meta-item meta-contact"),g("<i>").addClass("fa fa-user").appendTo(t),n.showContactPicture&&e.contact.pictureurl&&g("<img>").addClass("contact-picture").attr("src",e.contact.pictureurl).attr("alt",e.contact.name).appendTo(t),g("<a>").addClass("contact-name").attr("href",e.contact.profileurl).text(e.contact.name).appendTo(t),a.append(t)),n.showLastmodified&&e.lastmodified&&(t=g("<div>").addClass("meta-item meta-lastmodified"),g("<i>").addClass("fa fa-calendar").appendTo(t),g("<span>").text(e.lastmodified).appendTo(t),a.append(t))},c=function(){if(d){d.empty();for(var e=Math.min(3,r.coursesCount-1),t=1;t<=e;t++){var a=(r.currentIndex+t)%r.coursesCount,a=i[a],n=g("<div>").addClass("course-card").attr("data-course-id",a.id).attr("role","button").attr("tabindex","0").attr("aria-label",a.fullname),o=g("<div>").addClass("course-card-image");g("<img>").attr("src",a.courseimage).attr("alt",a.fullname).appendTo(o),n.append(o),g("<div>").addClass("course-card-title").text(a.fullname).appendTo(n),d.append(n)}}},l=function(e){o.attr("data-course-id",e.id),o.find(".main-course-image img").attr("src",e.courseimage).attr("alt",e.fullname);var t=o.find(".main-course-title a.course-title-link");(t.length?t.attr("href",e.viewurl):o.find(".main-course-title")).text(e.fullname),o.find(".main-course-description").text(e.summary||""),n.showButton&&(t=o.find(".button-container a")).length&&t.attr("href",e.enrollurl),u(e)},m=function(e){n.animationSpeed<=0?e():(o.css("opacity",0),window.setTimeout(function(){e(),o.animate({opacity:1},n.animationSpeed)},n.animationSpeed/2))},f=function(){var e;r.coursesCount&&(e=i[r.currentIndex],s(),m(function(){l(e)}),c())},p=function(){n.autoslide<=0||r.coursesCount<=1||(r.autoslideTimer=window.setInterval(function(){r.currentIndex=(r.currentIndex+1)%r.coursesCount,f()},n.autoslide))},h=function(){r.autoslideTimer&&(window.clearInterval(r.autoslideTimer),r.autoslideTimer=null),p()};if(e.on("click keydown",".slider-nav.prev",function(e){x(e)&&(e.preventDefault(),r.currentIndex=(r.currentIndex-1+r.coursesCount)%r.coursesCount,f(),h())}),e.on("click keydown",".slider-nav.next",function(e){x(e)&&(e.preventDefault(),r.currentIndex=(r.currentIndex+1)%r.coursesCount,f(),h())}),e.on("click keydown",".course-card",function(e){if(x(e)){e.preventDefault();for(var t=g(this).attr("data-course-id"),a=0;a<i.length;a++)if(i[a].id==t){r.currentIndex=a,f(),h();break}}}),e.on("click",".slider-indicators .dot",function(e){e.preventDefault();e=parseInt(g(this).attr("data-index"),10);isNaN(e)||e===r.currentIndex||(r.currentIndex=e,f(),h())}),e.on("mouseenter",".main-course-wrapper",function(){r.autoslideTimer&&window.clearInterval(r.autoslideTimer)}),e.on("mouseleave",".main-course-wrapper",function(){0<n.autoslide&&p()}),o.removeClass("layout-vertical layout-horizontal layout-card layout-minimal").addClass("layout-"+n.layoutMode),o.find(".main-course").css("border-radius",n.borderRadius+"px"),o.find(".main-course-image").css("height",n.imageHeight+"px"),o.find(".main-course-image img").css("object-fit",n.imageFit),1<r.coursesCount)if(r.coursesCount<=1)a.hide();else{a.empty();for(var C=0;C<r.coursesCount;C++){var w=g("<div>").addClass("dot").attr("data-index",C);g("<span>").addClass("tooltip").text(i[C].fullname).appendTo(w),C===r.currentIndex&&w.addClass("active"),a.append(w)}}else e.find(".slider-nav").hide(),a.hide();f(),p()}}}}}});